<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Vendor - Drone Demo</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
<header>
  <h1>ğŸ´ Vendor Panel</h1>
    <nav>
  <a href="/">User</a>
  <a href="/vendor">Vendor</a>
  <a href="/admin">Admin</a>
</nav>

</header>

<main>
  <section class="card" style="grid-column:span 2">
    <h2>Incoming Orders</h2>
    <div id="incoming" class="order-list"></div>
  </section>
</main>

<script src="/static/script.js"></script>
<script>
document.addEventListener("DOMContentLoaded", ()=>{
  const incoming = document.getElementById("incoming");

  function render() {
    const orders = JSON.parse(localStorage.getItem("orders")||"[]");
    incoming.innerHTML = "";
    orders.forEach(o=>{
      const div = document.createElement("div");
      div.className="order-item";
      div.innerHTML = `<div>${o.item} â€” ${o.block} [${o.status}]</div>
        <div style="display:flex;gap:.4rem;margin-top:.3rem">
          <button data-id="${o.id}" data-status="ACCEPTED">Accept</button>
          <button data-id="${o.id}" data-status="DECLINED">Decline</button>
          <button data-id="${o.id}" data-status="READY">Ready</button>
          <button data-id="${o.id}" data-status="LAUNCHED">Launch ğŸš€</button>
        </div>`;
      incoming.appendChild(div);
    });
  }

  incoming.addEventListener("click", e=>{
    const btn = e.target.closest("button");
    if(!btn) return;
    const id = Number(btn.dataset.id);
    const status = btn.dataset.status;
    const orders = JSON.parse(localStorage.getItem("orders")||"[]");
    const idx = orders.findIndex(o=>o.id===id);
    if(idx>-1){ orders[idx].status=status; localStorage.setItem("orders", JSON.stringify(orders)); render(); }
  });

  setInterval(render, 1000);
});
</script>
</body>
</html>
